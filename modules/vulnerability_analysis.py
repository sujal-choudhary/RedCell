import requests

NVD_API = "https://services.nvd.nist.gov/rest/json/cves/2.0"


def fetch_cves(keyword, limit=3):
    try:
        params = {
            "keywordSearch": keyword,
            "resultsPerPage": limit
        }
        r = requests.get(NVD_API, params=params, timeout=10)
        data = r.json()

        vulns = []
        for item in data.get("vulnerabilities", []):
            cve = item["cve"]
            vulns.append({
                "id": cve["id"],
                "description": cve["descriptions"][0]["value"],
                "severity": cve.get("metrics", {})
            })
        return vulns

    except Exception:
        return []


def risk_score(cves):
    if not cves:
        return "LOW"
    if len(cves) >= 3:
        return "HIGH"
    return "MEDIUM"
